# Werewolf Game Judgeï¼ˆç‹¼äººæ€ç¬¬ä¸€æ™šç”µå­æ³•å®˜ï¼‰

è¿™æ˜¯ä¸€æ¬¾ä¸º**çº¿ä¸‹åŒæ¡Œç‹¼äººæ€**è®¾è®¡çš„â€œç”µå­æ³•å®˜â€Appï¼Œä¸“æ³¨å®Œæˆ**ç¬¬ä¸€æ™š**çš„è‡ªåŠ¨æ’­æŠ¥ã€è¡ŒåŠ¨æ”¶é›†ä¸ç»“æœç»“ç®—ã€‚

æ ¸å¿ƒå®šä½ï¼š
- âœ… çº¿ä¸‹åŒæ¡Œ / å¤šè®¾å¤‡ä¸€èµ·ç”¨
- âœ… Hostï¼ˆæˆ¿ä¸»ï¼‰ä¹Ÿæ˜¯ç©å®¶ï¼Œå¤œæ™šåº”å½“é—­çœ¼ï¼Œç”± App æ’­æŠ¥å¼•å¯¼
- âœ… åªè´Ÿè´£ç¬¬ä¸€æ™šï¼šå¤œæ™šç»“æŸåè¾“å‡º **â€œæ­»äº¡ / å¹³å®‰å¤œâ€**ï¼›ç™½å¤©å‘è¨€ä¸æŠ•ç¥¨çº¿ä¸‹è‡ªè¡Œè¿›è¡Œ

---

## ç»™ç©å®¶çš„å¿«é€Ÿå¼€å§‹

### 1) åˆ›å»ºæˆ¿é—´ï¼ˆHostï¼‰

1. æ‰“å¼€ Appï¼Œç‚¹å‡» **ã€Œåˆ›å»ºæˆ¿é—´ã€**
2. é€‰æ‹©æ¿å­ï¼ˆè§’è‰²é…ç½®ï¼‰ä¸äººæ•°
3. ç”Ÿæˆ **4 ä½æˆ¿é—´å·**ï¼ˆä¾‹å¦‚ï¼š1234ï¼‰ï¼Œå‘ç»™å…¶ä»–ç©å®¶

### 2) åŠ å…¥æˆ¿é—´ï¼ˆç©å®¶ï¼‰

1. ç‚¹å‡» **ã€Œè¿›å…¥æˆ¿é—´ã€**
2. è¾“å…¥ 4 ä½æˆ¿é—´å·
3. ç‚¹å‡»åº§ä½å· **å…¥åº§**
   - è‹¥æç¤º **â€œXå·åº§å·²è¢«å ç”¨â€**ï¼Œè¯´æ˜æœ‰äººå·²ç»åäº†è¿™ä¸ªä½ç½®ï¼Œè¯·æ¢åº§

### 3) åˆ†é…èº«ä»½ä¸å¼€å§‹ç¬¬ä¸€æ™šï¼ˆHostï¼‰

1. æ‰€æœ‰äººå…¥åº§åï¼ŒHost ç‚¹å‡» **ã€Œå‡†å¤‡çœ‹ç‰Œã€**ï¼ˆåˆ†é…èº«ä»½ï¼‰
2. æ¯ä½ç©å®¶ç‚¹å‡» **ã€ŒæŸ¥çœ‹èº«ä»½ã€** ç¡®è®¤è‡ªå·±çš„ç‰Œ
3. æ‰€æœ‰äººç¡®è®¤å®Œæ¯•ï¼ŒHost ç‚¹å‡» **ã€Œå¼€å§‹æ¸¸æˆã€**ï¼ŒApp è¿›å…¥ç¬¬ä¸€æ™šæ’­æŠ¥ä¸è¡ŒåŠ¨é˜¶æ®µ

### 4) å¤œæ™šç»“æŸï¼ˆHost å®£å¸ƒç»“æœï¼‰

å¤œæ™šç»“æŸåï¼ŒHost ç‚¹å‡» **ã€ŒæŸ¥çœ‹æ˜¨æ™šä¿¡æ¯ã€**ï¼ŒApp ä¼šæ˜¾ç¤ºï¼š
- âœ… å¹³å®‰å¤œ
- âœ… æˆ–æ­»äº¡ç©å®¶åº§ä½å·

> è¯´æ˜ï¼šç™½å¤©æµç¨‹ï¼ˆå‘è¨€/æŠ•ç¥¨/å¤„åˆ‘ï¼‰ä¸åœ¨ App å†…ã€‚

---

## çº¿ä¸‹ç©æ³• SOPï¼ˆå¼ºçƒˆæ¨èï¼‰

ï¿½ **[çº¿ä¸‹ç©æ³• SOPï¼ˆç¬¬ä¸€æ™šç”µå­æ³•å®˜ï¼‰](docs/offline-sop.md)**

è¿™ä»½ SOP è¦†ç›–ï¼š
- å¼€å±€å‡†å¤‡ä¸è§’è‰²åˆ†é…
- ç¬¬ä¸€æ™šæµç¨‹æ¦‚è§ˆ
- éŸ³é¢‘å¼‚å¸¸è¯´æ˜
- å¡ä½/æ•‘ç«åè®®ï¼ˆğŸ§¯ æ•‘ç«é‡å¼€ï¼‰
- å¸¸è§é—®é¢˜

---

## E2E æµ‹è¯•ï¼šLocal / Remote Supabase åˆ‡æ¢

E2E æµ‹è¯•æ”¯æŒåœ¨æœ¬åœ° Supabase ä¸è¿œç¨‹ Supabase ä¹‹é—´åˆ‡æ¢ï¼š

```bash
# ä½¿ç”¨æœ¬åœ° Supabaseï¼ˆé»˜è®¤ï¼Œ127.0.0.1:54321ï¼‰
E2E_ENV=local npx playwright test e2e/basic.spec.ts

# ä½¿ç”¨è¿œç¨‹ Supabaseï¼ˆç”Ÿäº§/å…±äº«ç¯å¢ƒï¼‰
E2E_ENV=remote npx playwright test e2e/basic.spec.ts

# æ¨èï¼šè¿è¡Œæ ¸å¿ƒ E2E æµ‹è¯•ï¼ˆé€šè¿‡ e2e:core è„šæœ¬ï¼‰
E2E_ENV=local npm run e2e:core
E2E_ENV=remote npm run e2e:core
```

> æ³¨æ„ï¼šæ ¸å¿ƒ E2E éœ€ `--workers=1`ï¼Œé¿å… Supabase/Realtime channel èµ„æºç«äº‰å¯¼è‡´çš„å¶å‘å¤±è´¥ã€‚

**é…ç½®æ–‡ä»¶ä½ç½®ï¼š**
- `env/e2e.local.json` - æœ¬åœ° Supabase é…ç½®
- `env/e2e.remote.json` - è¿œç¨‹ Supabase é…ç½®ï¼ˆå¯é€šè¿‡ CI secrets è¦†ç›–ï¼‰

**CI ä½¿ç”¨ï¼š** è®¾ç½® `EXPO_PUBLIC_SUPABASE_URL` å’Œ `EXPO_PUBLIC_SUPABASE_ANON_KEY` ç¯å¢ƒå˜é‡å³å¯è¦†ç›– remote é…ç½®ã€‚

---

## æ¶æ„è¯´æ˜ï¼ˆç®€ç‰ˆï¼‰

### Host as authorityï¼ˆæˆ¿ä¸»æ˜¯é€»è¾‘æƒå¨ï¼‰

è¿™æ¬¾ App çš„â€œæ¸¸æˆé€»è¾‘æƒå¨â€åœ¨ Hostï¼ˆæˆ¿ä¸»è®¾å¤‡ï¼‰æœ¬åœ°å†…å­˜ä¸­ï¼ŒåŒ…æ‹¬ï¼š
- ç¬¬ä¸€æ™šæµç¨‹æ¨è¿›ã€é˜¶æ®µé¡ºåºä¸è®¡æ—¶
- è§’è‰²è¡ŒåŠ¨çš„æ‰§è¡Œä¸æ ¡éªŒ
- éŸ³é¢‘æ’­æŠ¥çš„æ¨è¿›ä¸å…œåº•
- ç¬¬ä¸€æ™šæ­»äº¡ç»“ç®—

### Supabase åªåšç³»ç»Ÿå±‚

Supabase ä»…ç”¨äºï¼š
- æˆ¿é—´å­˜åœ¨ä¸å‘ç°ï¼ˆ4 ä½æˆ¿é—´å·ï¼‰
- ç”¨æˆ·èº«ä»½ï¼ˆåŒ¿å/æ³¨å†Œï¼‰
- å®æ—¶æ¶ˆæ¯ä¼ è¾“ï¼ˆRealtime Broadcastï¼‰
- ç³»ç»Ÿå±‚æ¸…ç†ï¼ˆæˆ¿é—´è¶…æ—¶ç­‰ï¼‰

Supabase **ä¸ä¼š**ï¼š
- æ‰§è¡Œæ¸¸æˆé€»è¾‘
- æ ¡éªŒå¤œæ™šè¡ŒåŠ¨
- å­˜å‚¨å¯¹å±€è¿‡ç¨‹æ•°æ®ã€æŠ•ç¥¨ã€ç»“ç®—ç»“æœ

---

## Project Structure

```
src/
â”œâ”€â”€ components/      # Reusable UI components
â”‚   â”œâ”€â”€ Button/
â”‚   â”œâ”€â”€ AlertModal.tsx
â”‚   â””â”€â”€ Avatar.tsx
â”œâ”€â”€ constants/       # App constants and role definitions
â”œâ”€â”€ hooks/           # Custom React hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â””â”€â”€ useRoom.ts
â”œâ”€â”€ models/          # TypeScript interfaces
â”‚   â”œâ”€â”€ Player.ts
â”‚   â”œâ”€â”€ Room.ts
â”‚   â””â”€â”€ Template.ts
â”œâ”€â”€ navigation/      # React Navigation setup
â”œâ”€â”€ screens/         # Screen components
â”‚   â”œâ”€â”€ HomeScreen/
â”‚   â”œâ”€â”€ ConfigScreen/
â”‚   â”œâ”€â”€ RoomScreen/
â”‚   â”œâ”€â”€ JoinRoomScreen/
â”‚   â””â”€â”€ SettingsScreen/
â””â”€â”€ services/        # Business logic services
    â”œâ”€â”€ AudioService.ts
    â”œâ”€â”€ AuthService.ts
    â”œâ”€â”€ AvatarUploadService.ts
    â”œâ”€â”€ RoomService.ts
    â””â”€â”€ SeatService.ts
```

## FAQï¼ˆç©å®¶å‘ï¼‰

### Q1ï¼šæç¤ºã€Œéœ€è¦ç™»å½•ã€æ€ä¹ˆåŠï¼Ÿ

å¯ä»¥ä½¿ç”¨**åŒ¿åç™»å½•**ï¼Œä¸éœ€è¦æ³¨å†Œè´¦å·å³å¯ä½¿ç”¨ã€‚

### Q2ï¼šå‡ºç°ã€ŒåŠ è½½è¶…æ—¶ã€æ€ä¹ˆåŠï¼Ÿ

å…ˆç‚¹ **ã€Œé‡è¯•ã€**ã€‚å¦‚æœä»å¤±è´¥ï¼Œè¯·ç¡®è®¤ï¼š
- ä½ è¾“å…¥çš„æˆ¿é—´å·ä¸ Host æ˜¾ç¤ºçš„ 4 ä½æˆ¿é—´å·ä¸€è‡´
- ç½‘ç»œå¯ç”¨ï¼ˆåŒä¸€ Wiâ€‘Fi é€šå¸¸æ›´ç¨³å®šï¼‰

---

## Getting Startedï¼ˆå¼€å‘è€…ï¼‰

### Prerequisites

- Node.js >= 20.19.4
- npm or yarn
- Expo CLI
- iOS Simulator / Android Emulator / Physical device

### Installation

1. Clone the repository
2. Install dependencies:
   ```bash
   npm install
   ```

3. Configure Supabase:
    - Dashboard setup: `docs/SUPABASE_SETUP.md`
    - Supabase CLI + migrations: `supabase/README.md`
    - Create a local `.env` (do not commit) with:
       - `EXPO_PUBLIC_SUPABASE_URL`
       - `EXPO_PUBLIC_SUPABASE_ANON_KEY`

4. Add audio assets:
   - Place audio files in `assets/audio/` and `assets/audio_end/`
   - Place role images in `assets/images/`

### Running the App

```bash
# Start development server
npm start

# Run on iOS
npm run ios

# Run on Android
npm run android

# Run on Web
npm run web
```

## Game Roles

### Wolf Team ğŸº
- Wolf (ç‹¼äºº)
- Wolf King (ç‹¼ç‹)
- Wolf Queen (ç‹¼å)
- Wolf Brother (ç‹¼å…„)
- Robot Wolf (æœºæ¢°ç‹¼)
- Hidden Wolf (éšç‹¼)
- Wolf Seeder (ç§ç‹¼)

### God Team âš¡
- Seer (é¢„è¨€å®¶)
- Witch (å¥³å·«)
- Hunter (çŒäºº)
- Guard (å®ˆå«)
- Knight (éª‘å£«)
- Idiot (ç™½ç—´)
- Cupid (ä¸˜æ¯”ç‰¹)
- Magician (é­”æœ¯å¸ˆ)
- And more...

### Villager Team ğŸ‘¥
- Villager (æ‘æ°‘)
- Bride (æ–°å¨˜)

## Tech Stack

- **Framework**: React Native with Expo
- **Language**: TypeScript
- **Navigation**: React Navigation
- **State Management**: React Hooks
- **Backend**: Supabase (Auth + `rooms` table + Realtime Broadcast)
- **Audio**: expo-audio

## License

MIT
