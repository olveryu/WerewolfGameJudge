# 线下玩法 SOP（第一晚电子法官）

## 产品定位

这款 App 专为**线下同桌、多设备**场景设计，仅负责**第一晚的电子法官**工作。Host（房主）同时也是玩家，夜晚时应当闭眼，由 App 自动播放语音引导流程。

---

## 1. 开局准备

### 1.1 创建房间（Host）
1. Host 打开 App，点击「创建房间」
2. 选择游戏板子（角色配置），确认人数
3. 生成 4 位房间号，分享给其他玩家

### 1.2 加入房间（玩家）
1. 玩家打开 App，点击「进入房间」
2. 输入 4 位房间号
3. 点击座位入座（1-12 号位）

### 1.3 分配角色
1. 所有人入座后，Host 点击「准备看牌」
2. 系统自动分配角色
3. 每位玩家点击「查看身份」确认自己的角色
4. 所有人确认后，Host 点击「开始游戏」

---

## 2. 第一晚流程概览

第一晚的流程完全由 App 自动播放语音引导：

```
🌙 夜晚开始语音
    ↓
🐺 狼人行动语音 → 狼人玩家选择目标
    ↓
🔮 预言家行动语音 → 预言家选择查验目标
    ↓
🧙 女巫行动语音 → 女巫选择是否用药
    ↓
... 按板子配置依次进行 ...
    ↓
☀️ 夜晚结束语音
    ↓
📢 Host 屏幕显示昨晚结果（死亡/平安夜）
```

**注意**：白天流程由玩家自行进行（发言、投票等），App 仅负责第一晚。

---

## 3. 音频异常说明

### 正常情况
App 会自动依次播放各角色的行动语音。每段语音播放完毕后等待对应玩家操作。

### 异常处理（已内置保护）
- **音频文件缺失**：跳过该段语音，继续下一步
- **播放失败/被中断**：自动跳过，不会卡死流程
- **播放超时（15 秒）**：自动放弃等待，继续流程

> ✅ 音频问题不会导致游戏卡死。

### 仍可能卡住的情况
- **玩家不操作**：某位玩家一直不点击选择目标
- **设备锁屏/后台**：玩家手机锁屏导致无法提交行动

这些需要通过线下沟通或「重新开始」解决。

---

## 4. 卡住 / 重开处理

### 4.1 何时需要重开？
- 某个角色行动阶段长时间无进展（如 2 分钟以上）
- 玩家反馈设备出问题、App 无响应
- 有人误操作导致流程混乱

### 4.2 线下处理步骤
1. **大家喊停** — 有人发现问题后口头喊停
2. **宣布本局作废** — Host 宣布："本局作废，我们重来"
3. **所有人睁眼** — 不再保密当前身份

### 4.3 Host 操作重新开始
1. Host 在屏幕上找到「重新开始」按钮
   - 夜晚进行中：按钮为**黄色**（紧急重开）
   - 夜晚结束后：按钮为**绿色**（正常重开）
2. 点击后弹出确认对话框
3. 系统自动：
   - 清空当前夜晚的所有行动记录
   - **重新洗牌、重新分配角色**
   - 回到「已分配角色」状态

### 4.4 重开后
1. 所有玩家重新点击「查看身份」确认新角色
2. Host 点击「开始游戏」
3. 重新进入第一晚

---

## 5. 风险与公平性声明

### 关于重新开始
- 🚨 **重新开始会重新发身份**，不是恢复原来的身份
- 🚫 **不用于纠错**：如果有人看错身份或操作失误，不应该用重新开始来"修正"
- ✅ **只用于重开**：真正卡死、无法继续时才使用

### 权限说明
- 只有 Host 能看到「重新开始」按钮
- 只有 Host 能执行重开操作
- 建议 Host 在操作前口头征得所有人同意

---

## 6. 常见问题

### Q1: 没有声音怎么办？
**A:** 请检查：
1. 手机是否静音/音量是否调低
2. App 是否有音频权限
3. 如果仍无声音，流程不会卡死（有 fallback），可以让 Host 口头报出当前行动角色

### Q2: 有人一直不点击操作怎么办？
**A:** 
1. 线下口头提醒该玩家操作
2. 如果设备有问题，可以让 Host 使用「重新开始」
3. 如果是故意不操作，建议线下协商处理

### Q3: 想换板子/角色配置怎么做？
**A:** 
1. 游戏未开始时：Host 点击「⚙️ 设置」修改板子
2. 游戏进行中：需要先使用「重新开始」，然后再修改

### Q4: 可以中途退出吗？
**A:** 
- 可以退出 App，但退出后座位不会自动释放
- 建议在退出前通知 Host

### Q5: 第一晚结束后怎么办？
**A:** 
1. Host 点击「查看昨晚信息」获取死亡结果
2. Host 口头宣布昨晚结果
3. 白天流程由玩家自行进行（发言、投票、处决等）
4. 需要下一晚时，可点击「重新开始」使用相同板子开始新一局

---

## 快速参考卡片

| 场景 | Host 操作 |
|------|-----------|
| 所有人入座完毕 | 点击「准备看牌」 |
| 所有人确认身份 | 点击「开始游戏」 |
| 第一晚结束 | 点击「查看昨晚信息」 |
| 想重开一局 | 点击「重新开始」 |
| 想换板子 | 点击「⚙️ 设置」 |
